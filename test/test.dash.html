

<head>
	<!-- Load plotly.js into the DOM -->
	<script src='https://cdn.plot.ly/plotly-2.0.0.min.js'></script>
  <title>s</title>
</head>

<h1>查詢商品</h1>
<input autofocus type="text" placeholder="輸入搜尋關鍵字" id="s" value="asus">
<button type="button" onclick="butt()">開始查詢</button>
<div id='myDiv'></div>
<script src="https://code.jquery.com/jquery-3.4.1.js"
      integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="crossorigin="anonymous"></script>

<script>
butt() //首次執行

function butt() {
s = $("#s").val();
document.title = s;
const api = 'http://127.0.0.1:19132/s/' + s;
$.ajax({
  type: "GET",
  url: api,
  dataType: "json",
  crossDomain : true,
  success: function (response) {
    const jsond = [];
    jsond.push(...response);
    lodata(jsond);
  },
  error: function (thrownError) {
    console.log(thrownError);
  }
});

function lodata(jsond) {

	console.log(jsond);
	var x = [], y = [], standard_deviation = [];

	for (var i=0; i<jsond.length; i++) {
		row = jsond[i];
		x.push( row['by'] );
		y.push( row['name'] );
    console.log(row)
	}
	console.log( 'X',x, 'Y',y, 'SD',standard_deviation );
	makePlotly( x, y, standard_deviation );
}

function makePlotly( x, y, standard_deviation ){
	var plotDiv = document.getElementById("plot");
	var traces = [{
		x: x, 
		y: y,
    type: 'bar'
	}];

	Plotly.newPlot('myDiv', traces, 
		{title: '商品價格(無排序)'});
};
  makeplot();


};

</script>
<!-- css part -->
<style>

</style>